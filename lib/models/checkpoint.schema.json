{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://vps-provision/schemas/checkpoint.json",
  "title": "Checkpoint",
  "description": "Schema for phase completion checkpoint metadata",
  "type": "object",
  "required": ["phase_name", "completed_at", "session_id", "checksum"],
  "properties": {
    "phase_name": {
      "type": "string",
      "enum": [
        "system-prep",
        "desktop-install",
        "rdp-config",
        "user-creation",
        "ide-vscode",
        "ide-cursor",
        "ide-antigravity",
        "terminal-setup",
        "dev-tools",
        "verification"
      ],
      "description": "Name of completed phase"
    },
    "completed_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when phase finished"
    },
    "session_id": {
      "type": "string",
      "pattern": "^[0-9]{8}-[0-9]{6}$",
      "description": "ID of session that completed phase"
    },
    "checksum": {
      "type": "string",
      "pattern": "^[a-f0-9]{64}$",
      "description": "SHA-256 hash of critical files/state for integrity verification"
    },
    "verification_files": {
      "type": "array",
      "description": "List of files included in checksum calculation",
      "items": {
        "type": "string"
      }
    }
  }
}
